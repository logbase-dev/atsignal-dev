'use client';

import { useEffect, useState } from 'react';
import { usePathname } from 'next/navigation';

export default function Splash() {
  const [isVisible, setIsVisible] = useState(true);
  const [isMounted, setIsMounted] = useState(false);
  const pathname = usePathname();

  // 클라이언트에서만 마운트되도록 처리 (Hydration 에러 방지)
  useEffect(() => {
    setIsMounted(true);
  }, []);

  useEffect(() => {
    if (!isMounted) return;
    
    // 홈페이지(/ 또는 /ko, /en)에서만 스플래시 표시
    // 정규식으로 홈페이지 경로 확인: /, /ko, /en, /ko/, /en/
    const isHomePage = /^\/(ko|en)?\/?$/.test(pathname);
    
    if (isHomePage) {
      setIsVisible(true);
      
      // SVG 애니메이션 완료 시간(1.5초) + 여유 시간을 고려하여 2.5초 후 스플래시 숨김
      const timer = setTimeout(() => {
        setIsVisible(false);
      }, 2500);
      
      return () => clearTimeout(timer);
    } else {
      setIsVisible(false);
    }
  }, [pathname, isMounted]);

  // 서버 렌더링 시에는 아무것도 렌더링하지 않음 (Hydration 에러 방지)
  if (!isMounted) {
    return null;
  }

  // return null 대신 CSS로만 숨김 (DOM에는 남아있어서 SVG 애니메이션이 안전하게 완료됨)
  return (
    <div 
      className="splash-screen" 
      style={{ 
        display: isVisible ? 'flex' : 'none', // CSS의 display: flex를 유지
        pointerEvents: isVisible ? 'auto' : 'none'
      }}
    >
      <div className="splash-content">
        <svg width="731" height="216" viewBox="0 0 731 216" fill="none" xmlns="http://www.w3.org/2000/svg" className="splash-logo" preserveAspectRatio="xMidYMid meet" overflow="visible">
          <defs>
            <clipPath id="circleRevealClip" clipPathUnits="userSpaceOnUse">
              <circle cx="365.5" cy="108" r="0" className="reveal-circle">
                <animate attributeName="r" from="0" to="500" dur="1.5s" fill="freeze"/>
              </circle>
            </clipPath>
          </defs>
          {/* 파란색 띠 - 원형 마스크로 부드럽게 나타남 */}
          <g className="splash-blue-bar" clipPath="url(#circleRevealClip)">
            <g className="blue-bar-inner">
              <path d="M125.61 59.9492C96.04 59.9492 72 74.3492 72 92.2092V102.829C72 88.1092 96.04 77.8092 125.61 77.8092C155.18 77.8092 179.21 91.4092 179.21 106.129V95.5092C179.21 77.7292 155.25 59.9492 125.61 59.9492ZM117.07 125.419C87.51 125.419 72 117.639 72 102.829V113.449C72 131.229 87.43 143.119 117.07 143.119V125.409V125.419ZM117.07 151.109V169.049C147.84 164.949 179.22 146.649 179.22 117.019L179.2 106.129C179.2 143.209 117.07 151.109 117.07 151.109Z" fill="#20BDFF"/>
            </g>
          </g>
          {/* 텍스트 부분 - 나중에 나타남 */}
          <g clipPath="url(#clip0_199_4482)" className="splash-text">
              <path d="M267.41 83.9698H266.89C262.53 76.3498 255.49 72.5098 246.31 72.5098C227.88 72.5098 214.72 87.7498 214.66 107.94C214.72 128.13 227.88 143.37 246.31 143.37C255.49 143.37 262.53 139.53 266.89 131.91H267.41V141.55H283.43V74.3298H267.41V83.9698ZM249.44 128.65C238.5 128.58 230.88 119.99 230.81 107.94C230.87 95.8898 238.49 87.2998 249.44 87.2298C260.19 87.2898 267.94 95.7598 267.94 107.94C267.94 120.12 260.19 128.58 249.44 128.65Z" fill="#ffffff"/>
              <path d="M316.419 59.6602H300.399V74.3302H289.199V86.9602H300.399V119.26C300.469 134.5 308.539 143.36 322.539 143.36C326.379 143.36 329.699 142.64 332.439 141.67V127.08C329.959 127.73 327.689 128.06 325.539 128.12C319.219 128.06 316.419 125.12 316.419 118.35V86.9602H332.439V74.3302H316.419V59.6602Z" fill="#ffffff"/>
              <path d="M367.121 100.51L363.601 99.5998C356.181 97.7798 353.901 96.2798 353.961 93.0898C353.901 88.8598 358.191 86.0598 364.641 86.0598C370.631 86.0598 375.581 88.3998 380.011 93.0898L389.781 83.4498C383.331 76.4798 374.351 72.5098 364.641 72.5098C349.791 72.5098 338.661 81.4298 338.721 93.4798C338.661 103.05 345.751 109.5 360.081 112.89L363.471 113.8C372.521 116.01 375.391 117.9 375.321 122.01C375.381 126.89 371.021 129.82 363.341 129.82C356.311 129.82 351.361 127.61 346.281 122.27L336.381 131.91C342.831 139.4 352.211 143.37 363.081 143.37C379.561 143.37 390.691 134.51 390.691 121.62C390.691 111 383.331 104.43 367.111 100.52L367.121 100.51Z" fill="#ffffff"/>
              <path d="M405 51C399.46 51.07 395.23 55.17 395.23 60.64C395.23 66.11 399.46 70.34 405 70.28C410.54 70.35 414.77 66.18 414.77 60.64C414.77 55.1 410.54 51.07 405 51Z" fill="#ffffff"/>
              <path d="M412.941 75.7695H397.051V143.55H412.941V75.7695Z" fill="#ffffff"/>
              <path d="M471.921 83.7608H471.531C467.171 76.4008 460.131 72.6908 450.951 72.6908C432.521 72.6908 419.361 87.5408 419.301 107.081C419.361 126.621 432.521 141.471 450.951 141.471C460.131 141.471 467.171 137.761 471.531 130.401H471.921V131.961C472.051 146.551 464.821 154.431 451.861 154.491C443.591 154.431 437.531 151.231 431.541 143.551L420.601 152.801C429.201 163.421 438.831 168.691 452.381 168.691C474.331 168.691 488.001 155.011 487.941 131.961V72.3008H471.921V83.7608ZM454.081 127.001C443.141 127.061 435.521 118.731 435.451 107.071C435.511 95.4108 443.131 87.0808 454.081 87.1408C464.831 87.0708 472.581 95.3508 472.581 107.071C472.581 118.791 464.831 127.061 454.081 127.001Z" fill="#ffffff"/>
              <path d="M534.54 74.5091C525.03 74.5091 517.61 78.9991 514.09 86.2291H513.57V74.1191H497.68V143.539H513.57V108.629C513.63 95.2091 520.86 89.2891 529.2 89.2191C537.67 89.2791 542.49 95.2091 542.36 105.889V143.529H558.38V103.279C558.44 85.4391 549.78 74.4891 534.54 74.4891V74.5091Z" fill="#ffffff"/>
              <path d="M617.48 83.9698H616.96C612.6 76.3498 605.56 72.5098 596.38 72.5098C577.95 72.5098 564.79 87.7498 564.73 107.94C564.79 128.13 577.95 143.37 596.38 143.37C605.56 143.37 612.6 139.53 616.96 131.91H617.48V141.55H633.5V74.3298H617.48V83.9698ZM599.5 128.65C588.56 128.58 580.94 119.99 580.87 107.94C580.93 95.8898 588.55 87.2998 599.5 87.2298C610.25 87.2898 618 95.7598 618 107.94C618 120.12 610.25 128.58 599.5 128.65Z" fill="#ffffff"/>
              <path d="M659.06 51H643.17V143.54H659.06V51Z" fill="#ffffff"/>
          </g>
          <defs>
            <clipPath id="clip0_199_4482">
              <rect width="587.06" height="150" fill="white" transform="translate(72 40)"/>
            </clipPath>
          </defs>
        </svg>
      </div>
    </div>
  );
}

